<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="_laser_8cpp_source" xml:lang="zh">
<title>laser.cpp</title>
<indexterm><primary>HW-Components/devices/laser/src/laser.cpp</primary></indexterm>
浏览该文件的文档.<programlisting linenumbering="unnumbered"><anchor xml:id="_laser_8cpp_source_1l00001"/>00001 
<anchor xml:id="_laser_8cpp_source_1l00016"/>00016 <emphasis role="comment">/*&#32;Includes&#32;------------------------------------------------------------------*/</emphasis>
<anchor xml:id="_laser_8cpp_source_1l00017"/>00017 <emphasis role="preprocessor">#include&#32;&quot;<link linkend="_laser_8hpp">laser.hpp</link>&quot;</emphasis>
<anchor xml:id="_laser_8cpp_source_1l00018"/>00018 
<anchor xml:id="_laser_8cpp_source_1l00019"/>00019 <emphasis role="preprocessor">#include&#32;&quot;<link linkend="_assert_8hpp">assert.hpp</link>&quot;</emphasis>
<anchor xml:id="_laser_8cpp_source_1l00020"/>00020 <emphasis role="preprocessor">#include&#32;&quot;<link linkend="_base_8hpp">base.hpp</link>&quot;</emphasis>
<anchor xml:id="_laser_8cpp_source_1l00021"/>00021 
<anchor xml:id="_laser_8cpp_source_1l00022"/>00022 <emphasis role="keyword">namespace&#32;</emphasis><link linkend="_namespacehello__world">hello_world</link>
<anchor xml:id="_laser_8cpp_source_1l00023"/>00023 {
<anchor xml:id="_laser_8cpp_source_1l00024"/>00024 <emphasis role="keyword">namespace&#32;</emphasis>devices
<anchor xml:id="_laser_8cpp_source_1l00025"/>00025 {
<anchor xml:id="_laser_8cpp_source_1l00026"/>00026 <emphasis role="keyword">namespace&#32;</emphasis>laser
<anchor xml:id="_laser_8cpp_source_1l00027"/>00027 {
<anchor xml:id="_laser_8cpp_source_1l00028"/>00028 <emphasis role="comment">/*&#32;Private&#32;macro&#32;-------------------------------------------------------------*/</emphasis>
<anchor xml:id="_laser_8cpp_source_1l00029"/>00029 <emphasis role="comment">/*&#32;Private&#32;constants&#32;---------------------------------------------------------*/</emphasis>
<anchor xml:id="_laser_8cpp_source_1l00030"/>00030 <emphasis role="comment">/*&#32;Private&#32;types&#32;-------------------------------------------------------------*/</emphasis>
<anchor xml:id="_laser_8cpp_source_1l00031"/>00031 <emphasis role="comment">/*&#32;Private&#32;variables&#32;---------------------------------------------------------*/</emphasis>
<anchor xml:id="_laser_8cpp_source_1l00032"/>00032 <emphasis role="comment">/*&#32;External&#32;variables&#32;--------------------------------------------------------*/</emphasis>
<anchor xml:id="_laser_8cpp_source_1l00033"/>00033 <emphasis role="comment">/*&#32;Private&#32;function&#32;prototypes&#32;-----------------------------------------------*/</emphasis>
<anchor xml:id="_laser_8cpp_source_1l00034"/>00034 
<anchor xml:id="_laser_8cpp_source_1l00044"/><link linkend="_classhello__world_1_1devices_1_1laser_1_1_laser_1ade6858f65e516d3f2d99e140e27eeb21">00044</link> <link linkend="_classhello__world_1_1devices_1_1laser_1_1_laser_1ade6858f65e516d3f2d99e140e27eeb21">Laser::Laser</link>(TIM_HandleTypeDef&#32;*htim,&#32;uint32_t&#32;channel,&#32;<emphasis role="keywordtype">float</emphasis>&#32;init_lumin_pct)
<anchor xml:id="_laser_8cpp_source_1l00045"/>00045 &#32;&#32;&#32;&#32;:&#32;kHtim_(htim),&#32;kChannel_(channel)
<anchor xml:id="_laser_8cpp_source_1l00046"/>00046 {
<anchor xml:id="_laser_8cpp_source_1l00047"/>00047 &#32;&#32;<emphasis role="comment">/*&#32;变量检查&#32;*/</emphasis>
<anchor xml:id="_laser_8cpp_source_1l00048"/>00048 <emphasis role="preprocessor">#pragma&#32;region</emphasis>
<anchor xml:id="_laser_8cpp_source_1l00049"/>00049 &#32;&#32;<link linkend="_assert_8hpp_1a5969df827ceb603bed14c4106586484a">HW_ASSERT</link>(IS_TIM_INSTANCE(<link linkend="_classhello__world_1_1devices_1_1laser_1_1_laser_1a855fe4a608cd7a3be9648ed1023cb96c">kHtim_</link>-&gt;Instance),&#32;<emphasis role="stringliteral">&quot;Error&#32;TIM&#32;handle&quot;</emphasis>);
<anchor xml:id="_laser_8cpp_source_1l00050"/>00050 &#32;&#32;<link linkend="_assert_8hpp_1a5969df827ceb603bed14c4106586484a">HW_ASSERT</link>(IS_TIM_CHANNELS(<link linkend="_classhello__world_1_1devices_1_1laser_1_1_laser_1aad5f30954299751858b4b78238061e3d">kChannel_</link>),&#32;<emphasis role="stringliteral">&quot;Error&#32;TIM&#32;channel:&#32;%d&quot;</emphasis>,&#32;<link linkend="_classhello__world_1_1devices_1_1laser_1_1_laser_1aad5f30954299751858b4b78238061e3d">kChannel_</link>);
<anchor xml:id="_laser_8cpp_source_1l00051"/>00051 <emphasis role="preprocessor">#pragma&#32;endregion</emphasis>
<anchor xml:id="_laser_8cpp_source_1l00052"/>00052 
<anchor xml:id="_laser_8cpp_source_1l00053"/>00053 &#32;&#32;__HAL_TIM_SET_COMPARE(<link linkend="_classhello__world_1_1devices_1_1laser_1_1_laser_1a855fe4a608cd7a3be9648ed1023cb96c">kHtim_</link>,&#32;<link linkend="_classhello__world_1_1devices_1_1laser_1_1_laser_1aad5f30954299751858b4b78238061e3d">kChannel_</link>,&#32;<link linkend="_classhello__world_1_1devices_1_1laser_1_1_laser_1a71727ea81371581d369751653e0fc5ca">luminPct2Cmp</link>(init_lumin_pct));
<anchor xml:id="_laser_8cpp_source_1l00054"/>00054 &#32;&#32;HAL_TIM_PWM_Start(<link linkend="_classhello__world_1_1devices_1_1laser_1_1_laser_1a855fe4a608cd7a3be9648ed1023cb96c">kHtim_</link>,&#32;<link linkend="_classhello__world_1_1devices_1_1laser_1_1_laser_1aad5f30954299751858b4b78238061e3d">kChannel_</link>);
<anchor xml:id="_laser_8cpp_source_1l00055"/>00055 }
<anchor xml:id="_laser_8cpp_source_1l00056"/>00056 
<anchor xml:id="_laser_8cpp_source_1l00063"/><link linkend="_classhello__world_1_1devices_1_1laser_1_1_laser_1ae18c0d286f4c46619adf603ef47ecdb5">00063</link> <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_classhello__world_1_1devices_1_1laser_1_1_laser_1ae18c0d286f4c46619adf603ef47ecdb5">Laser::setLuminPct</link>(<emphasis role="keywordtype">float</emphasis>&#32;lumin_pct)<emphasis role="keyword">&#32;const</emphasis>
<anchor xml:id="_laser_8cpp_source_1l00064"/>00064 <emphasis role="keyword"></emphasis>{
<anchor xml:id="_laser_8cpp_source_1l00065"/>00065 &#32;&#32;__HAL_TIM_SET_COMPARE(<link linkend="_classhello__world_1_1devices_1_1laser_1_1_laser_1a855fe4a608cd7a3be9648ed1023cb96c">kHtim_</link>,&#32;<link linkend="_classhello__world_1_1devices_1_1laser_1_1_laser_1aad5f30954299751858b4b78238061e3d">kChannel_</link>,&#32;<link linkend="_classhello__world_1_1devices_1_1laser_1_1_laser_1a71727ea81371581d369751653e0fc5ca">luminPct2Cmp</link>(lumin_pct));
<anchor xml:id="_laser_8cpp_source_1l00066"/>00066 }
<anchor xml:id="_laser_8cpp_source_1l00067"/>00067 
<anchor xml:id="_laser_8cpp_source_1l00074"/><link linkend="_classhello__world_1_1devices_1_1laser_1_1_laser_1a71727ea81371581d369751653e0fc5ca">00074</link> uint32_t&#32;<link linkend="_classhello__world_1_1devices_1_1laser_1_1_laser_1a71727ea81371581d369751653e0fc5ca">Laser::luminPct2Cmp</link>(<emphasis role="keywordtype">float</emphasis>&#32;lumin_pct)<emphasis role="keyword">&#32;const</emphasis>
<anchor xml:id="_laser_8cpp_source_1l00075"/>00075 <emphasis role="keyword"></emphasis>{
<anchor xml:id="_laser_8cpp_source_1l00076"/>00076 &#32;&#32;lumin_pct&#32;=&#32;<link linkend="_namespacehello__world_1a34cb06299a34f746d556d23dc16904aa">Bound</link>(lumin_pct,&#32;0.0f,&#32;100.0f);
<anchor xml:id="_laser_8cpp_source_1l00077"/>00077 &#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(
<anchor xml:id="_laser_8cpp_source_1l00078"/>00078 &#32;&#32;&#32;&#32;&#32;&#32;lumin_pct&#32;*&#32;__HAL_TIM_GET_AUTORELOAD(<link linkend="_classhello__world_1_1devices_1_1laser_1_1_laser_1a855fe4a608cd7a3be9648ed1023cb96c">kHtim_</link>)&#32;/&#32;100);
<anchor xml:id="_laser_8cpp_source_1l00079"/>00079 }
<anchor xml:id="_laser_8cpp_source_1l00080"/>00080 }&#32;&#32;<emphasis role="comment">//&#32;namespace&#32;laser</emphasis>
<anchor xml:id="_laser_8cpp_source_1l00081"/>00081 }&#32;&#32;<emphasis role="comment">//&#32;namespace&#32;devices</emphasis>
<anchor xml:id="_laser_8cpp_source_1l00082"/>00082 }&#32;&#32;<emphasis role="comment">//&#32;namespace&#32;hello_world</emphasis>
</programlisting></section>
