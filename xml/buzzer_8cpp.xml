<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.8" xml:lang="zh">
  <compounddef id="buzzer_8cpp" kind="file" language="C++">
    <compoundname>buzzer.cpp</compoundname>
    <includes refid="buzzer_8hpp" local="yes">buzzer.hpp</includes>
    <includes local="no">cmath</includes>
    <includes refid="assert_8hpp" local="yes">assert.hpp</includes>
    <includes refid="base_8hpp" local="yes">base.hpp</includes>
    <includes refid="tick_8hpp" local="yes">tick.hpp</includes>
    <incdepgraph>
      <node id="2">
        <label>buzzer.hpp</label>
        <link refid="buzzer_8hpp"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
      </node>
      <node id="1">
        <label>HW-Components/devices/buzzer/src/buzzer.cpp</label>
        <link refid="buzzer_8cpp"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
      </node>
      <node id="10">
        <label>tick.hpp</label>
        <link refid="tick_8hpp"/>
        <childnode refid="11" relation="include">
        </childnode>
      </node>
      <node id="7">
        <label>assert.hpp</label>
        <link refid="assert_8hpp"/>
      </node>
      <node id="8">
        <label>base.hpp</label>
        <link refid="base_8hpp"/>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
      </node>
      <node id="4">
        <label>system.hpp</label>
        <link refid="system_8hpp"/>
        <childnode refid="5" relation="include">
        </childnode>
      </node>
      <node id="6">
        <label>cmath</label>
      </node>
      <node id="9">
        <label>cstdint</label>
      </node>
      <node id="5">
        <label>cstdlib</label>
      </node>
      <node id="11">
        <label>stdint.h</label>
      </node>
      <node id="3">
        <label>stm32f4xx_hal.h</label>
      </node>
    </incdepgraph>
    <innernamespace refid="namespacehello__world">hello_world</innernamespace>
    <innernamespace refid="namespacehello__world_1_1devices">hello_world::devices</innernamespace>
    <innernamespace refid="namespacehello__world_1_1devices_1_1buzzer">hello_world::devices::buzzer</innernamespace>
    <briefdescription>
<para>: @history : Version Date Author Note V0.9.0 2023-11-28 Caikunzhen 1. </para>
    </briefdescription>
    <detaileddescription>
<para>未测试版本 V1.0.0 2023-12-05 Caikunzhen 1. 完成测试</para>
<para><simplesect kind="attention"><para>:</para>
</simplesect>
Copyright (c) 2023 Hello World Team, Zhejiang University. All Rights Reserved. </para>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Includes<sp/>------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="buzzer_8hpp" kindref="compound">buzzer.hpp</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;cmath&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="assert_8hpp" kindref="compound">assert.hpp</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="base_8hpp" kindref="compound">base.hpp</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="tick_8hpp" kindref="compound">tick.hpp</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="keyword">namespace<sp/></highlight><highlight class="normal"><ref refid="namespacehello__world" kindref="compound">hello_world</ref></highlight></codeline>
<codeline lineno="26"><highlight class="normal">{</highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="keyword">namespace<sp/></highlight><highlight class="normal">devices</highlight></codeline>
<codeline lineno="28"><highlight class="normal">{</highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight><highlight class="keyword">namespace<sp/></highlight><highlight class="normal">buzzer</highlight></codeline>
<codeline lineno="30"><highlight class="normal">{</highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Private<sp/>macro<sp/>-------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Private<sp/>constants<sp/>---------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight></codeline>
<codeline lineno="34" refid="namespacehello__world_1_1devices_1_1buzzer_1a3c9fc26c3cdc343d34458d093dd3cc5f" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="namespacehello__world_1_1devices_1_1buzzer_1a3c9fc26c3cdc343d34458d093dd3cc5f" kindref="member">kTimerFreq</ref><sp/>=<sp/>1e6f;</highlight></codeline>
<codeline lineno="35" refid="namespacehello__world_1_1devices_1_1buzzer_1a482cb003f98ad42ba36d039c6c2a1317" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="namespacehello__world_1_1devices_1_1buzzer_1a482cb003f98ad42ba36d039c6c2a1317" kindref="member">kMaxDuty</ref><sp/>=<sp/>0.5f;<sp/><sp/></highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Private<sp/>types<sp/>-------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Private<sp/>variables<sp/>---------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>External<sp/>variables<sp/>--------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Private<sp/>function<sp/>prototypes<sp/>-----------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight></codeline>
<codeline lineno="51" refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a9901a266077ad9867ddad94ecab40d2d" refkind="member"><highlight class="normal"><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a9901a266077ad9867ddad94ecab40d2d" kindref="member">Buzzer::Buzzer</ref>(TIM_HandleTypeDef<sp/>*htim,<sp/>uint32_t<sp/>channel,</highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacehello__world_1_1devices_1_1buzzer_1a2e5d78b68fcdefd56e87870dfb59b4d9" kindref="member">PlayConfig</ref><sp/>play_config,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structhello__world_1_1devices_1_1buzzer_1_1_tune_list_info" kindref="compound">TuneListInfo</ref><sp/>*kTuneListInfoPtr)</highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/>:<sp/>kHtim_(htim),<sp/>kChannel_(channel),<sp/>play_config_(play_config)</highlight></codeline>
<codeline lineno="54"><highlight class="normal">{</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>变量检查<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="56"><highlight class="normal"></highlight><highlight class="preprocessor">#pragma<sp/>region</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><ref refid="assert_8hpp_1a5969df827ceb603bed14c4106586484a" kindref="member">HW_ASSERT</ref>(IS_TIM_INSTANCE(<ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a3b838c1b98dc600c53705e9fe04d99a4" kindref="member">kHtim_</ref>-&gt;Instance),<sp/></highlight><highlight class="stringliteral">&quot;Error<sp/>TIM<sp/>handle&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><ref refid="assert_8hpp_1a5969df827ceb603bed14c4106586484a" kindref="member">HW_ASSERT</ref>(IS_TIM_CHANNELS(<ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a15bb4ff8e5ba9bc2d340063ba0058bb7" kindref="member">kChannel_</ref>),<sp/></highlight><highlight class="stringliteral">&quot;Error<sp/>TIM<sp/>channel:<sp/>%d&quot;</highlight><highlight class="normal">,<sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a15bb4ff8e5ba9bc2d340063ba0058bb7" kindref="member">kChannel_</ref>);</highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><ref refid="assert_8hpp_1a5969df827ceb603bed14c4106586484a" kindref="member">HW_ASSERT</ref>(play_config<sp/>==<sp/><ref refid="namespacehello__world_1_1devices_1_1buzzer_1a2e5d78b68fcdefd56e87870dfb59b4d9a4e59bb85f2a47ce95c7c5868775d9348" kindref="member">kPlayConfigLoopPlayback</ref><sp/>||</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>play_config<sp/>==<sp/><ref refid="namespacehello__world_1_1devices_1_1buzzer_1a2e5d78b68fcdefd56e87870dfb59b4d9a7c37348a5faa1a2dc387e5376e22f992" kindref="member">kPlayConfigSinglePlayback</ref>,</highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Error<sp/>play<sp/>config:<sp/>%d&quot;</highlight><highlight class="normal">,<sp/>tune_list_info.play_config);</highlight></codeline>
<codeline lineno="62"><highlight class="normal"></highlight><highlight class="preprocessor">#pragma<sp/>endregion</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a67595f4b9558ce6320b85f9c580f7b95" kindref="member">setNewTune</ref>(kTuneListInfoPtr);</highlight></codeline>
<codeline lineno="65"><highlight class="normal">}</highlight></codeline>
<codeline lineno="66"><highlight class="normal"></highlight></codeline>
<codeline lineno="67" refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a4186105c4e8cedc66d9363698c2e0e9b" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a4186105c4e8cedc66d9363698c2e0e9b" kindref="member">Buzzer::set_play_config</ref>(<ref refid="namespacehello__world_1_1devices_1_1buzzer_1a2e5d78b68fcdefd56e87870dfb59b4d9" kindref="member">PlayConfig</ref><sp/>play_config)</highlight></codeline>
<codeline lineno="68"><highlight class="normal">{</highlight></codeline>
<codeline lineno="69"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>变量检查<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="70"><highlight class="normal"></highlight><highlight class="preprocessor">#pragma<sp/>region</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><ref refid="assert_8hpp_1a5969df827ceb603bed14c4106586484a" kindref="member">HW_ASSERT</ref>(play_config<sp/>==<sp/><ref refid="namespacehello__world_1_1devices_1_1buzzer_1a2e5d78b68fcdefd56e87870dfb59b4d9a4e59bb85f2a47ce95c7c5868775d9348" kindref="member">kPlayConfigLoopPlayback</ref><sp/>||</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>play_config<sp/>==<sp/><ref refid="namespacehello__world_1_1devices_1_1buzzer_1a2e5d78b68fcdefd56e87870dfb59b4d9a7c37348a5faa1a2dc387e5376e22f992" kindref="member">kPlayConfigSinglePlayback</ref>,</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Error<sp/>play<sp/>config:<sp/>%d&quot;</highlight><highlight class="normal">,<sp/>tune_list_info.play_config);</highlight></codeline>
<codeline lineno="74"><highlight class="normal"></highlight><highlight class="preprocessor">#pragma<sp/>endregion</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"></highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a552e1698456e2a148072f21ed59abaaa" kindref="member">play_config_</ref><sp/>=<sp/>play_config;</highlight></codeline>
<codeline lineno="77"><highlight class="normal">}</highlight></codeline>
<codeline lineno="78"><highlight class="normal"></highlight></codeline>
<codeline lineno="87" refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a67595f4b9558ce6320b85f9c580f7b95" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a67595f4b9558ce6320b85f9c580f7b95" kindref="member">Buzzer::setNewTune</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structhello__world_1_1devices_1_1buzzer_1_1_tune_list_info" kindref="compound">TuneListInfo</ref><sp/>*kTuneListInfoPtr)</highlight></codeline>
<codeline lineno="88"><highlight class="normal">{</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a3b93cc23f3be6bb791b9a0ca9dacad39" kindref="member">tune_idx_</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1ab4775b8ae94a043ac58824f4ebb4be37" kindref="member">tune_start_tick_</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a8947005e9e7acd2250aec39402bdb9e9" kindref="member">tune_switch_</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1ade3f992137ca255598cda0947b55f778" kindref="member">is_playing_</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1ad0d5171f1e0990b68bfbc4392d73d7b3" kindref="member">last_is_playing_</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1abcbd00189b50b82539d9b86d97694ad6" kindref="member">kTuneListInfoPtr_</ref><sp/>=<sp/>kTuneListInfoPtr;</highlight></codeline>
<codeline lineno="95"><highlight class="normal"></highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/>__HAL_TIM_SET_AUTORELOAD(<ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a3b838c1b98dc600c53705e9fe04d99a4" kindref="member">kHtim_</ref>,<sp/>0);</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/>__HAL_TIM_SET_COMPARE(<ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a3b838c1b98dc600c53705e9fe04d99a4" kindref="member">kHtim_</ref>,<sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a15bb4ff8e5ba9bc2d340063ba0058bb7" kindref="member">kChannel_</ref>,<sp/>0);</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/>HAL_TIM_PWM_Start(<ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a3b838c1b98dc600c53705e9fe04d99a4" kindref="member">kHtim_</ref>,<sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a15bb4ff8e5ba9bc2d340063ba0058bb7" kindref="member">kChannel_</ref>);</highlight></codeline>
<codeline lineno="99"><highlight class="normal">}</highlight></codeline>
<codeline lineno="100"><highlight class="normal"></highlight></codeline>
<codeline lineno="106" refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1ab4a10c92796395a9b6c229f0bfec9cdb" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1ab4a10c92796395a9b6c229f0bfec9cdb" kindref="member">Buzzer::play</ref>()</highlight></codeline>
<codeline lineno="107"><highlight class="normal">{</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1ade3f992137ca255598cda0947b55f778" kindref="member">is_playing_</ref>)<sp/>{</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="111"><highlight class="normal"></highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/>uint32_t<sp/>tick<sp/>=<sp/><ref refid="namespacehello__world_1_1dsp_1_1tick_1a97910b07255da1979f8ceafd8c6d2ea5" kindref="member">dsp::tick::GetTickMs</ref>();</highlight></codeline>
<codeline lineno="113"><highlight class="normal"></highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>播放结束处理<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1abcbd00189b50b82539d9b86d97694ad6" kindref="member">kTuneListInfoPtr_</ref>-&gt;<ref refid="structhello__world_1_1devices_1_1buzzer_1_1_tune_list_info_1a0aefddbb58c23c7d906baf5bce59a4bf" kindref="member">list</ref>[<ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a3b93cc23f3be6bb791b9a0ca9dacad39" kindref="member">tune_idx_</ref>]<sp/>==<sp/><ref refid="namespacehello__world_1_1devices_1_1buzzer_1a0db5beb79cee27259eaefb4a2a04126da6944bb0666e55eb573bc605afeff6695" kindref="member">kTuneEnd</ref>)<sp/>{</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a552e1698456e2a148072f21ed59abaaa" kindref="member">play_config_</ref><sp/>==<sp/><ref refid="namespacehello__world_1_1devices_1_1buzzer_1a2e5d78b68fcdefd56e87870dfb59b4d9a4e59bb85f2a47ce95c7c5868775d9348" kindref="member">kPlayConfigLoopPlayback</ref>)<sp/>{</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a8947005e9e7acd2250aec39402bdb9e9" kindref="member">tune_switch_</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a3b93cc23f3be6bb791b9a0ca9dacad39" kindref="member">tune_idx_</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1ade3f992137ca255598cda0947b55f778" kindref="member">is_playing_</ref><sp/>=<sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1ad0d5171f1e0990b68bfbc4392d73d7b3" kindref="member">last_is_playing_</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a8947005e9e7acd2250aec39402bdb9e9" kindref="member">tune_switch_</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a3b93cc23f3be6bb791b9a0ca9dacad39" kindref="member">tune_idx_</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1ab2c457527b41d290e2e68101c508b73a" kindref="member">mute</ref>();</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="127"><highlight class="normal"></highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>切换音符<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a8947005e9e7acd2250aec39402bdb9e9" kindref="member">tune_switch_</ref>)<sp/>{</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a8947005e9e7acd2250aec39402bdb9e9" kindref="member">tune_switch_</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>auto_reload<sp/>=<sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a4098153da83266e584a961b94e2213c4" kindref="member">tune2AutoReload</ref>(<ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1abcbd00189b50b82539d9b86d97694ad6" kindref="member">kTuneListInfoPtr_</ref>-&gt;<ref refid="structhello__world_1_1devices_1_1buzzer_1_1_tune_list_info_1a0aefddbb58c23c7d906baf5bce59a4bf" kindref="member">list</ref>[<ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a3b93cc23f3be6bb791b9a0ca9dacad39" kindref="member">tune_idx_</ref>]);</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>intensity_scale<sp/>=</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacehello__world_1a34cb06299a34f746d556d23dc16904aa" kindref="member">hello_world::Bound</ref>(<ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1abcbd00189b50b82539d9b86d97694ad6" kindref="member">kTuneListInfoPtr_</ref>-&gt;<ref refid="structhello__world_1_1devices_1_1buzzer_1_1_tune_list_info_1a4cb3c97639dfe61c0729c40b80380fa1" kindref="member">intensity_scale</ref>,<sp/>0,<sp/>1);</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>duty<sp/>=<sp/><ref refid="namespacehello__world_1_1devices_1_1buzzer_1a482cb003f98ad42ba36d039c6c2a1317" kindref="member">kMaxDuty</ref><sp/>*<sp/>intensity_scale;</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/>__HAL_TIM_SET_AUTORELOAD(<ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a3b838c1b98dc600c53705e9fe04d99a4" kindref="member">kHtim_</ref>,<sp/>auto_reload);</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/>__HAL_TIM_SET_COMPARE(<ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a3b838c1b98dc600c53705e9fe04d99a4" kindref="member">kHtim_</ref>,<sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a15bb4ff8e5ba9bc2d340063ba0058bb7" kindref="member">kChannel_</ref>,<sp/>auto_reload<sp/>*<sp/>duty);</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="138"><highlight class="normal"></highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1ad0d5171f1e0990b68bfbc4392d73d7b3" kindref="member">last_is_playing_</ref><sp/>&amp;&amp;<sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1ade3f992137ca255598cda0947b55f778" kindref="member">is_playing_</ref>)<sp/>{<sp/><sp/></highlight><highlight class="comment">//<sp/>刚开始播放</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1ab4775b8ae94a043ac58824f4ebb4be37" kindref="member">tune_start_tick_</ref><sp/>=<sp/>tick;</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(tick<sp/>-<sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1ab4775b8ae94a043ac58824f4ebb4be37" kindref="member">tune_start_tick_</ref><sp/>&gt;=<sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1abcbd00189b50b82539d9b86d97694ad6" kindref="member">kTuneListInfoPtr_</ref>-&gt;<ref refid="structhello__world_1_1devices_1_1buzzer_1_1_tune_list_info_1abfacb236c2a5ef6dc1499c96af943738" kindref="member">tune_duration</ref>)<sp/>{</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1ab4775b8ae94a043ac58824f4ebb4be37" kindref="member">tune_start_tick_</ref><sp/>=<sp/>tick;</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a3b93cc23f3be6bb791b9a0ca9dacad39" kindref="member">tune_idx_</ref>++;</highlight></codeline>
<codeline lineno="144"><highlight class="normal"></highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a3b93cc23f3be6bb791b9a0ca9dacad39" kindref="member">tune_idx_</ref><sp/>&gt;=<sp/><ref refid="namespacehello__world_1_1devices_1_1buzzer_1a0beaff31c15a2e1e53c17cba47b8111b" kindref="member">kTuneListMaxLen</ref>)<sp/>{<sp/><sp/></highlight><highlight class="comment">//<sp/>音符溢出处理</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1ade3f992137ca255598cda0947b55f778" kindref="member">is_playing_</ref><sp/>=<sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1ad0d5171f1e0990b68bfbc4392d73d7b3" kindref="member">last_is_playing_</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a8947005e9e7acd2250aec39402bdb9e9" kindref="member">tune_switch_</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a3b93cc23f3be6bb791b9a0ca9dacad39" kindref="member">tune_idx_</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1ab2c457527b41d290e2e68101c508b73a" kindref="member">mute</ref>();</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a8947005e9e7acd2250aec39402bdb9e9" kindref="member">tune_switch_</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="155"><highlight class="normal"></highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1ad0d5171f1e0990b68bfbc4392d73d7b3" kindref="member">last_is_playing_</ref><sp/>=<sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1ade3f992137ca255598cda0947b55f778" kindref="member">is_playing_</ref>;</highlight></codeline>
<codeline lineno="157"><highlight class="normal">}</highlight></codeline>
<codeline lineno="158"><highlight class="normal"></highlight></codeline>
<codeline lineno="165" refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a4098153da83266e584a961b94e2213c4" refkind="member"><highlight class="normal">uint32_t<sp/><ref refid="classhello__world_1_1devices_1_1buzzer_1_1_buzzer_1a4098153da83266e584a961b94e2213c4" kindref="member">Buzzer::tune2AutoReload</ref>(<ref refid="namespacehello__world_1_1devices_1_1buzzer_1a0db5beb79cee27259eaefb4a2a04126d" kindref="member">Tune</ref><sp/>tune)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="166"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(tune<sp/>&lt;<sp/>kTuneC3<sp/>||<sp/>tune<sp/>&gt;=<sp/><ref refid="namespacehello__world_1_1devices_1_1buzzer_1a0db5beb79cee27259eaefb4a2a04126daf58609de52719ad2c93932ad4e3272c5" kindref="member">kTuneRst</ref>)<sp/>{</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static_cast&lt;</highlight><highlight class="normal">uint32_t</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>440<sp/>*<sp/>2^((n-69)/12)<sp/>Hz</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacehello__world_1_1devices_1_1buzzer_1a3c9fc26c3cdc343d34458d093dd3cc5f" kindref="member">kTimerFreq</ref><sp/>/<sp/>440.0f<sp/>*<sp/>powf(1.05946f,<sp/>(tune)-69)<sp/>-<sp/>1);</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="174"><highlight class="normal">}</highlight></codeline>
<codeline lineno="175"><highlight class="normal">}<sp/><sp/></highlight><highlight class="comment">//<sp/>namespace<sp/>buzzer</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal">}<sp/><sp/></highlight><highlight class="comment">//<sp/>namespace<sp/>devices</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="177"><highlight class="normal">}<sp/><sp/></highlight><highlight class="comment">//<sp/>namespace<sp/>hello_world</highlight></codeline>
    </programlisting>
    <location file="HW-Components/devices/buzzer/src/buzzer.cpp"/>
  </compounddef>
</doxygen>
