<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="_tick_8cpp_source" xml:lang="zh">
<title>tick.cpp</title>
<indexterm><primary>HW-Components/dsp/tick/tick.cpp</primary></indexterm>
浏览该文件的文档.<programlisting linenumbering="unnumbered"><anchor xml:id="_tick_8cpp_source_1l00001"/>00001 
<anchor xml:id="_tick_8cpp_source_1l00002"/>00002 
<anchor xml:id="_tick_8cpp_source_1l00021"/>00021 <emphasis role="preprocessor">#include&#32;&quot;<link linkend="_tick_8hpp">tick.hpp</link>&quot;</emphasis>
<anchor xml:id="_tick_8cpp_source_1l00022"/>00022 
<anchor xml:id="_tick_8cpp_source_1l00023"/><link linkend="_tick_8cpp_1a11b4e8e0765b2c1c39b23bdb5be54416">00023</link> <emphasis role="preprocessor">#define&#32;USE_HAL_TICK</emphasis>
<anchor xml:id="_tick_8cpp_source_1l00024"/>00024 <emphasis role="preprocessor">#ifdef&#32;USE_UNIX_TICK</emphasis>
<anchor xml:id="_tick_8cpp_source_1l00025"/>00025 <emphasis role="comment">/*&#32;Includes&#32;------------------------------------------------------------------*/</emphasis>
<anchor xml:id="_tick_8cpp_source_1l00026"/>00026 <emphasis role="preprocessor">#include&#32;&lt;chrono&gt;</emphasis>
<anchor xml:id="_tick_8cpp_source_1l00027"/>00027 <emphasis role="preprocessor">#include&#32;&lt;ctime&gt;</emphasis>
<anchor xml:id="_tick_8cpp_source_1l00028"/>00028 <emphasis role="keyword">namespace&#32;</emphasis><link linkend="_namespacehello__world">hello_world</link>
<anchor xml:id="_tick_8cpp_source_1l00029"/>00029 {
<anchor xml:id="_tick_8cpp_source_1l00030"/>00030 <emphasis role="keyword">namespace&#32;</emphasis>dsp
<anchor xml:id="_tick_8cpp_source_1l00031"/>00031 {
<anchor xml:id="_tick_8cpp_source_1l00032"/>00032 <emphasis role="keyword">namespace&#32;</emphasis>tick
<anchor xml:id="_tick_8cpp_source_1l00033"/>00033 {
<anchor xml:id="_tick_8cpp_source_1l00034"/>00034 <emphasis role="comment">/*&#32;Private&#32;macro&#32;-------------------------------------------------------------*/</emphasis>
<anchor xml:id="_tick_8cpp_source_1l00035"/>00035 <emphasis role="comment">/*&#32;Private&#32;constants&#32;---------------------------------------------------------*/</emphasis>
<anchor xml:id="_tick_8cpp_source_1l00036"/>00036 <emphasis role="comment">/*&#32;Private&#32;types&#32;-------------------------------------------------------------*/</emphasis>
<anchor xml:id="_tick_8cpp_source_1l00037"/>00037 <emphasis role="comment">/*&#32;Private&#32;variables&#32;---------------------------------------------------------*/</emphasis>
<anchor xml:id="_tick_8cpp_source_1l00038"/>00038 std::chrono::microseconds&#32;<link linkend="_namespacehello__world_1_1dsp_1_1tick_1a22bb956e1d5ebc7cef5e5e11d54580de">start_tick_us</link>&#32;=&#32;std::chrono::duration_cast&lt;std::chrono::microseconds&gt;(std::chrono::system_clock::now().time_since_epoch());
<anchor xml:id="_tick_8cpp_source_1l00039"/>00039 <emphasis role="comment">/*&#32;External&#32;variables&#32;--------------------------------------------------------*/</emphasis>
<anchor xml:id="_tick_8cpp_source_1l00040"/>00040 <emphasis role="comment">/*&#32;Private&#32;function&#32;prototypes&#32;-----------------------------------------------*/</emphasis>
<anchor xml:id="_tick_8cpp_source_1l00041"/>00041 <emphasis role="comment">/*&#32;Exported&#32;function&#32;definitions&#32;-----------------------------------------------*/</emphasis>
<anchor xml:id="_tick_8cpp_source_1l00042"/>00042 uint32_t&#32;<link linkend="_namespacehello__world_1_1dsp_1_1tick_1a0c9c44ee367dc665cc6f1a6d830da9ee">GetTickUs</link>()
<anchor xml:id="_tick_8cpp_source_1l00043"/>00043 {
<anchor xml:id="_tick_8cpp_source_1l00044"/>00044 &#32;&#32;&#32;&#32;std::chrono::system_clock::time_point&#32;now&#32;=&#32;std::chrono::system_clock::now();
<anchor xml:id="_tick_8cpp_source_1l00045"/>00045 &#32;&#32;&#32;&#32;std::chrono::microseconds&#32;tick&#32;=&#32;std::chrono::duration_cast&lt;std::chrono::microseconds&gt;(now.time_since_epoch())&#32;-&#32;<link linkend="_namespacehello__world_1_1dsp_1_1tick_1a22bb956e1d5ebc7cef5e5e11d54580de">start_tick_us</link>;
<anchor xml:id="_tick_8cpp_source_1l00046"/>00046 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;(uint32_t)(tick.count());
<anchor xml:id="_tick_8cpp_source_1l00047"/>00047 };
<anchor xml:id="_tick_8cpp_source_1l00048"/>00048 
<anchor xml:id="_tick_8cpp_source_1l00049"/>00049 uint32_t&#32;<link linkend="_namespacehello__world_1_1dsp_1_1tick_1a97910b07255da1979f8ceafd8c6d2ea5">GetTickMs</link>()
<anchor xml:id="_tick_8cpp_source_1l00050"/>00050 {
<anchor xml:id="_tick_8cpp_source_1l00051"/>00051 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_namespacehello__world_1_1dsp_1_1tick_1a0c9c44ee367dc665cc6f1a6d830da9ee">GetTickUs</link>()&#32;/&#32;1000;
<anchor xml:id="_tick_8cpp_source_1l00052"/>00052 };
<anchor xml:id="_tick_8cpp_source_1l00053"/>00053 
<anchor xml:id="_tick_8cpp_source_1l00054"/>00054 uint32_t&#32;<link linkend="_namespacehello__world_1_1dsp_1_1tick_1a3bb6f5ee2096e411df77150fbac949a5">GetTickS</link>()
<anchor xml:id="_tick_8cpp_source_1l00055"/>00055 {
<anchor xml:id="_tick_8cpp_source_1l00056"/>00056 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_namespacehello__world_1_1dsp_1_1tick_1a97910b07255da1979f8ceafd8c6d2ea5">GetTickMs</link>()&#32;/&#32;1000;
<anchor xml:id="_tick_8cpp_source_1l00057"/>00057 };
<anchor xml:id="_tick_8cpp_source_1l00058"/>00058 <emphasis role="comment">/*&#32;Private&#32;function&#32;definitions&#32;-----------------------------------------------*/</emphasis>
<anchor xml:id="_tick_8cpp_source_1l00059"/>00059 }&#32;&#32;<emphasis role="comment">//&#32;namespace&#32;tick</emphasis>
<anchor xml:id="_tick_8cpp_source_1l00060"/>00060 
<anchor xml:id="_tick_8cpp_source_1l00061"/>00061 }&#32;&#32;<emphasis role="comment">//&#32;namespace&#32;dsp</emphasis>
<anchor xml:id="_tick_8cpp_source_1l00062"/>00062 
<anchor xml:id="_tick_8cpp_source_1l00063"/>00063 }&#32;&#32;<emphasis role="comment">//&#32;namespace&#32;hello_world</emphasis>
<anchor xml:id="_tick_8cpp_source_1l00064"/>00064 <emphasis role="preprocessor">#endif</emphasis>
<anchor xml:id="_tick_8cpp_source_1l00065"/>00065 
<anchor xml:id="_tick_8cpp_source_1l00066"/>00066 <emphasis role="preprocessor">#ifdef&#32;USE_HAL_TICK</emphasis>
<anchor xml:id="_tick_8cpp_source_1l00067"/>00067 <emphasis role="preprocessor">#include&#32;&quot;stm32f4xx_hal.h&quot;</emphasis>
<anchor xml:id="_tick_8cpp_source_1l00068"/>00068 <emphasis role="keyword">namespace&#32;</emphasis><link linkend="_namespacehello__world">hello_world</link>
<anchor xml:id="_tick_8cpp_source_1l00069"/>00069 {
<anchor xml:id="_tick_8cpp_source_1l00070"/><link linkend="_namespacehello__world_1_1dsp">00070</link> <emphasis role="keyword">namespace&#32;</emphasis>dsp
<anchor xml:id="_tick_8cpp_source_1l00071"/>00071 {
<anchor xml:id="_tick_8cpp_source_1l00072"/><link linkend="_namespacehello__world_1_1dsp_1_1tick">00072</link> <emphasis role="keyword">namespace&#32;</emphasis>tick
<anchor xml:id="_tick_8cpp_source_1l00073"/>00073 {
<anchor xml:id="_tick_8cpp_source_1l00074"/><link linkend="_namespacehello__world_1_1dsp_1_1tick_1a22bb956e1d5ebc7cef5e5e11d54580de">00074</link> uint32_t&#32;<link linkend="_namespacehello__world_1_1dsp_1_1tick_1a22bb956e1d5ebc7cef5e5e11d54580de">start_tick_us</link>&#32;=&#32;<link linkend="_namespacehello__world_1_1dsp_1_1tick_1a0c9c44ee367dc665cc6f1a6d830da9ee">GetTickUs</link>();
<anchor xml:id="_tick_8cpp_source_1l00075"/>00075 
<anchor xml:id="_tick_8cpp_source_1l00076"/><link linkend="_namespacehello__world_1_1dsp_1_1tick_1a0c9c44ee367dc665cc6f1a6d830da9ee">00076</link> uint32_t&#32;<link linkend="_namespacehello__world_1_1dsp_1_1tick_1a0c9c44ee367dc665cc6f1a6d830da9ee">GetTickUs</link>()
<anchor xml:id="_tick_8cpp_source_1l00077"/>00077 {
<anchor xml:id="_tick_8cpp_source_1l00078"/>00078 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;(uint32_t)((HAL_GetTick()&#32;*&#32;HAL_GetTickFreq())&#32;*&#32;1000&#32;+&#32;SysTick-&gt;VAL&#32;*&#32;1000&#32;/&#32;SysTick-&gt;LOAD)&#32;-&#32;<link linkend="_namespacehello__world_1_1dsp_1_1tick_1a22bb956e1d5ebc7cef5e5e11d54580de">start_tick_us</link>;
<anchor xml:id="_tick_8cpp_source_1l00079"/>00079 };
<anchor xml:id="_tick_8cpp_source_1l00080"/>00080 
<anchor xml:id="_tick_8cpp_source_1l00081"/><link linkend="_namespacehello__world_1_1dsp_1_1tick_1a97910b07255da1979f8ceafd8c6d2ea5">00081</link> uint32_t&#32;<link linkend="_namespacehello__world_1_1dsp_1_1tick_1a97910b07255da1979f8ceafd8c6d2ea5">GetTickMs</link>()
<anchor xml:id="_tick_8cpp_source_1l00082"/>00082 {
<anchor xml:id="_tick_8cpp_source_1l00083"/>00083 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_namespacehello__world_1_1dsp_1_1tick_1a0c9c44ee367dc665cc6f1a6d830da9ee">GetTickUs</link>()&#32;/&#32;1000;
<anchor xml:id="_tick_8cpp_source_1l00084"/>00084 };
<anchor xml:id="_tick_8cpp_source_1l00085"/>00085 
<anchor xml:id="_tick_8cpp_source_1l00086"/><link linkend="_namespacehello__world_1_1dsp_1_1tick_1a3bb6f5ee2096e411df77150fbac949a5">00086</link> uint32_t&#32;<link linkend="_namespacehello__world_1_1dsp_1_1tick_1a3bb6f5ee2096e411df77150fbac949a5">GetTickS</link>()
<anchor xml:id="_tick_8cpp_source_1l00087"/>00087 {
<anchor xml:id="_tick_8cpp_source_1l00088"/>00088 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_namespacehello__world_1_1dsp_1_1tick_1a97910b07255da1979f8ceafd8c6d2ea5">GetTickMs</link>()&#32;/&#32;1000;
<anchor xml:id="_tick_8cpp_source_1l00089"/>00089 };
<anchor xml:id="_tick_8cpp_source_1l00090"/>00090 }&#32;&#32;<emphasis role="comment">//&#32;namespace&#32;tick</emphasis>
<anchor xml:id="_tick_8cpp_source_1l00091"/>00091 
<anchor xml:id="_tick_8cpp_source_1l00092"/>00092 }&#32;&#32;<emphasis role="comment">//&#32;namespace&#32;dsp</emphasis>
<anchor xml:id="_tick_8cpp_source_1l00093"/>00093 
<anchor xml:id="_tick_8cpp_source_1l00094"/>00094 }&#32;&#32;<emphasis role="comment">//&#32;namespace&#32;hello_world</emphasis>
<anchor xml:id="_tick_8cpp_source_1l00095"/>00095 <emphasis role="preprocessor">#endif</emphasis>
</programlisting></section>
