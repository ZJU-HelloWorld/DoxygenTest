<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="_motor___g_m6020_8cpp_source" xml:lang="zh">
<title>motor_GM6020.cpp</title>
<indexterm><primary>HW-Components/devices/motor/src/motor_GM6020.cpp</primary></indexterm>
浏览该文件的文档.<programlisting linenumbering="unnumbered"><anchor xml:id="_motor___g_m6020_8cpp_source_1l00001"/>00001 
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00015"/>00015 <emphasis role="comment">/*&#32;Includes&#32;------------------------------------------------------------------*/</emphasis>
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00016"/>00016 <emphasis role="preprocessor">#include&#32;&quot;<link linkend="_motor___g_m6020_8hpp">motor_GM6020.hpp</link>&quot;</emphasis>
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00017"/>00017 
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00018"/>00018 <emphasis role="preprocessor">#include&#32;&quot;<link linkend="_assert_8hpp">assert.hpp</link>&quot;</emphasis>
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00019"/>00019 
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00020"/>00020 <emphasis role="keyword">namespace&#32;</emphasis><link linkend="_namespacehello__world">hello_world</link>
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00021"/>00021 {
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00022"/>00022 <emphasis role="keyword">namespace&#32;</emphasis>devices
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00023"/>00023 {
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00024"/>00024 <emphasis role="keyword">namespace&#32;</emphasis>motor
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00025"/>00025 {
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00026"/>00026 <emphasis role="comment">/*&#32;Private&#32;macro&#32;-------------------------------------------------------------*/</emphasis>
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00027"/>00027 <emphasis role="comment">/*&#32;Private&#32;constants&#32;---------------------------------------------------------*/</emphasis>
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00028"/>00028 <emphasis role="comment">/*&#32;Private&#32;types&#32;-------------------------------------------------------------*/</emphasis>
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00029"/>00029 <emphasis role="comment">/*&#32;Private&#32;variables&#32;---------------------------------------------------------*/</emphasis>
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00030"/>00030 
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00031"/><link linkend="_namespacehello__world_1_1devices_1_1motor_1a05fb66ade757503261251a0e07460d14">00031</link> <emphasis role="keyword">const</emphasis>&#32;<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_base_info">MotorBaseInfo</link>&#32;<link linkend="_namespacehello__world_1_1devices_1_1motor_1a05fb66ade757503261251a0e07460d14">kGM6020MotorBaseInfo</link>{
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00032"/>00032 &#32;&#32;&#32;&#32;.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_base_info_1a2b549445c9205d4d98b6afaab8a8a429">raw_input_lim</link>&#32;=&#32;30000,
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00033"/>00033 &#32;&#32;&#32;&#32;.torq_input_lim&#32;=&#32;<link linkend="_namespacehello__world_1_1devices_1_1motor_1abe2e70f5aab1c0e73122df8bad6de6a0">kInvalidValue</link>,&#32;&#32;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00034"/>00034 &#32;&#32;&#32;&#32;.curr_input_lim&#32;=&#32;<link linkend="_namespacehello__world_1_1devices_1_1motor_1abe2e70f5aab1c0e73122df8bad6de6a0">kInvalidValue</link>,&#32;&#32;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00035"/>00035 &#32;&#32;&#32;&#32;.torq_const&#32;=&#32;0.741f,
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00036"/>00036 &#32;&#32;&#32;&#32;.redu_rat&#32;=&#32;1.0f,
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00037"/>00037 &#32;&#32;&#32;&#32;.angle_rat&#32;=&#32;2&#32;*&#32;<link linkend="_base_8hpp_1a598a3330b3c21701223ee0ca14316eca">PI</link>&#32;/&#32;8191,
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00038"/>00038 &#32;&#32;&#32;&#32;.vel_rat&#32;=&#32;2&#32;*&#32;<link linkend="_base_8hpp_1a598a3330b3c21701223ee0ca14316eca">PI</link>&#32;/&#32;60,
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00039"/>00039 &#32;&#32;&#32;&#32;.curr_rat&#32;=&#32;0.078f&#32;/&#32;700,&#32;&#32;<emphasis role="comment">//&#32;TODO(Hello&#32;World):&#32;待定</emphasis>
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00040"/>00040 &#32;&#32;&#32;&#32;.torq_rat&#32;=&#32;<link linkend="_namespacehello__world_1_1devices_1_1motor_1abe2e70f5aab1c0e73122df8bad6de6a0">kInvalidValue</link>,
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00041"/>00041 &#32;&#32;&#32;&#32;.cross_0_value&#32;=&#32;8191U,
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00042"/>00042 &#32;&#32;&#32;&#32;.raw_mapping_type&#32;=&#32;<link linkend="_namespacehello__world_1_1devices_1_1motor_1a23bd0e79c78258c715635edf82874176acd89116c1ee1b0662fd89ebdfd1e2ea0">kRawMappingTypeCurr</link>,
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00043"/>00043 };
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00044"/>00044 <emphasis role="comment">/*&#32;External&#32;variables&#32;--------------------------------------------------------*/</emphasis>
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00045"/>00045 <emphasis role="comment">/*&#32;Private&#32;function&#32;prototypes&#32;-----------------------------------------------*/</emphasis>
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00046"/>00046 
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00054"/><link linkend="_classhello__world_1_1devices_1_1motor_1_1_g_m6020_1ad61341de888f13343d20bd7e0b06f3c1">00054</link> <link linkend="_classhello__world_1_1devices_1_1motor_1_1_g_m6020_1ad61341de888f13343d20bd7e0b06f3c1">GM6020::GM6020</link>(uint8_t&#32;<emphasis role="keywordtype">id</emphasis>,&#32;<emphasis role="keyword">const</emphasis>&#32;<link linkend="_structhello__world_1_1devices_1_1motor_1_1_optional_params">OptionalParams</link>&amp;&#32;optinal_params)
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00055"/>00055 {
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00056"/>00056 &#32;&#32;<emphasis role="comment">/*&#32;变量检查&#32;*/</emphasis>
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00057"/>00057 <emphasis role="preprocessor">#pragma&#32;region</emphasis>
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00058"/>00058 &#32;&#32;<link linkend="_assert_8hpp_1a5969df827ceb603bed14c4106586484a">HW_ASSERT</link>(1&#32;&lt;=&#32;<emphasis role="keywordtype">id</emphasis>&#32;&amp;&amp;&#32;<emphasis role="keywordtype">id</emphasis>&#32;&lt;=&#32;7,&#32;<emphasis role="stringliteral">&quot;Error&#32;id:&#32;%d&quot;</emphasis>,&#32;<emphasis role="keywordtype">id</emphasis>);
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00059"/>00059 &#32;&#32;<link linkend="_assert_8hpp_1a5969df827ceb603bed14c4106586484a">HW_ASSERT</link>(
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00060"/>00060 &#32;&#32;&#32;&#32;&#32;&#32;optinal_params.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_optional_params_1abb17f065132ebdcc2a00916fb36e2873">dir</link>&#32;==&#32;<link linkend="_namespacehello__world_1_1devices_1_1motor_1a44985d99992e9464953d243bf3b561fda8ef76451782f120b178cb02bdcbe9917">kDirFwd</link>&#32;||&#32;optinal_params.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_optional_params_1abb17f065132ebdcc2a00916fb36e2873">dir</link>&#32;==&#32;<link linkend="_namespacehello__world_1_1devices_1_1motor_1a44985d99992e9464953d243bf3b561fdac8903b06755144e29386752630029652">kDirRev</link>,
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00061"/>00061 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="stringliteral">&quot;Error&#32;dir:&#32;%d&quot;</emphasis>,&#32;optinal_params.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_optional_params_1abb17f065132ebdcc2a00916fb36e2873">dir</link>);
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00062"/>00062 &#32;&#32;<link linkend="_assert_8hpp_1a5969df827ceb603bed14c4106586484a">HW_ASSERT</link>(
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00063"/>00063 &#32;&#32;&#32;&#32;&#32;&#32;optinal_params.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_optional_params_1a1917a38f2bec6dbe8b7982ba4857142a">angle_range</link>&#32;==&#32;<link linkend="_namespacehello__world_1_1devices_1_1motor_1a0163710b33b99ac98bcbcb1f43d78248a7856b44581aabfcff60aedc2b603b471">kAngleRange0To2Pi</link>&#32;||
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00064"/>00064 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;optinal_params.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_optional_params_1a1917a38f2bec6dbe8b7982ba4857142a">angle_range</link>&#32;==&#32;<link linkend="_namespacehello__world_1_1devices_1_1motor_1a0163710b33b99ac98bcbcb1f43d78248a0e264d4f119a2e5d4c62691f3f35e317">kAngleRangeNegInfToPosInf</link>&#32;||
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00065"/>00065 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;optinal_params.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_optional_params_1a1917a38f2bec6dbe8b7982ba4857142a">angle_range</link>&#32;==&#32;<link linkend="_namespacehello__world_1_1devices_1_1motor_1a0163710b33b99ac98bcbcb1f43d78248a2f525a5ee04cacdb2fcbcdb636cf8e5a">kAngleRangeNegPiToPosPi</link>,
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00066"/>00066 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="stringliteral">&quot;Error&#32;angle&#32;range:&#32;%d&quot;</emphasis>,&#32;optinal_params.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_optional_params_1a1917a38f2bec6dbe8b7982ba4857142a">angle_range</link>);
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00067"/>00067 &#32;&#32;<link linkend="_assert_8hpp_1a5969df827ceb603bed14c4106586484a">HW_ASSERT</link>(
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00068"/>00068 &#32;&#32;&#32;&#32;&#32;&#32;optinal_params.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_optional_params_1a40afccbd81c17e22779f7df471f2ec0b">input_type</link>&#32;==&#32;<link linkend="_namespacehello__world_1_1devices_1_1motor_1a4777995093ebbd290b833795e49749b7a3af8d233b879c0e5323904dd850fbfe3">kInputTypeRaw</link>,
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00069"/>00069 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="stringliteral">&quot;Error&#32;input&#32;type:&#32;%d&quot;</emphasis>,&#32;optinal_params.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_optional_params_1a40afccbd81c17e22779f7df471f2ec0b">input_type</link>);
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00070"/>00070 &#32;&#32;<link linkend="_assert_8hpp_1a5969df827ceb603bed14c4106586484a">HW_ASSERT</link>(
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00071"/>00071 &#32;&#32;&#32;&#32;&#32;&#32;optinal_params.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_optional_params_1ab0a4704479885c3da95f9e0bee91026d">ex_redu_rat</link>&#32;&gt;&#32;0,
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00072"/>00072 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="stringliteral">&quot;Error&#32;external&#32;reduction&#32;ration:&#32;%f&quot;</emphasis>,&#32;optinal_params.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_optional_params_1ab0a4704479885c3da95f9e0bee91026d">ex_redu_rat</link>);
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00073"/>00073 &#32;&#32;<link linkend="_assert_8hpp_1a5969df827ceb603bed14c4106586484a">HW_ASSERT</link>(
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00074"/>00074 &#32;&#32;&#32;&#32;&#32;&#32;optinal_params.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_optional_params_1a406c5a28341a65489f7450f8800c7bc1">max_raw_input_lim</link>&#32;&gt;&#32;0,
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00075"/>00075 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="stringliteral">&quot;Error&#32;max&#32;raw&#32;input&#32;limit:&#32;%f&quot;</emphasis>,&#32;optinal_params.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_optional_params_1a406c5a28341a65489f7450f8800c7bc1">max_raw_input_lim</link>);
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00076"/>00076 <emphasis role="preprocessor">#pragma&#32;endregion</emphasis>
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00077"/>00077 
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00078"/>00078 &#32;&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>&#32;=&#32;<link linkend="_namespacehello__world_1_1devices_1_1motor_1a05fb66ade757503261251a0e07460d14">kGM6020MotorBaseInfo</link>;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00079"/>00079 
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00080"/>00080 &#32;&#32;<emphasis role="comment">/*&#32;根据&#32;ID&#32;设定报文&#32;ID&#32;*/</emphasis>
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00081"/>00081 &#32;&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_info_1a85fb9e3e5d5e207f69ad906f092b3ddc">tx_id</link>&#32;=&#32;<emphasis role="keywordtype">id</emphasis>&#32;&lt;=&#32;4&#32;?&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_g_m6020_1a284d777c18006c5e5ba05576f796cb6e">kTx1_4_</link>&#32;:&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_g_m6020_1a8746a4b46ed319f80d6d4196e6fcedcb">kTx5_7_</link>;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00082"/>00082 &#32;&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_info_1a3e96084a1a764a8bc1be4d4e34ef97b5">rx_id</link>&#32;=&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_g_m6020_1a99d3844cbaf71a0ba1a2694eae5f7411">kRx0_</link>&#32;+&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1ab3e2187f017e86c6d4a83caa55fe9419">id</link>;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00083"/>00083 &#32;&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_info_1ad5c740f3c72547a3d4b6a9ac07eb52fe">id</link>&#32;=&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1ab3e2187f017e86c6d4a83caa55fe9419">id</link>;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00084"/>00084 
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00085"/>00085 &#32;&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_info_1a16bfca55d6a9c16d3bed3794f59eae55">dir</link>&#32;=&#32;optinal_params.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_optional_params_1abb17f065132ebdcc2a00916fb36e2873">dir</link>;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00086"/>00086 &#32;&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_info_1a9e6c4b4561b5da0bb08b88c80953eece">angle_range</link>&#32;=&#32;optinal_params.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_optional_params_1a1917a38f2bec6dbe8b7982ba4857142a">angle_range</link>;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00087"/>00087 &#32;&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_info_1af8fc7f4030e24c85518c7239bcac9a86">input_type</link>&#32;=&#32;optinal_params.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_optional_params_1a40afccbd81c17e22779f7df471f2ec0b">input_type</link>;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00088"/>00088 &#32;&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_info_1a7d770e09d97238decfb61382deac39eb">angle_offset</link>&#32;=&#32;optinal_params.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_optional_params_1a36043885b6010524f0011531b6415e0a">angle_offset</link>;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00089"/>00089 &#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(optinal_params.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_optional_params_1a7324141855f9f70be7be484df0f511e6">remove_build_in_reducer</link>)&#32;{
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00090"/>00090 &#32;&#32;&#32;&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_base_info_1a01dc4c2e170bc8fd5a7a0a9f53492fa8">redu_rat</link>&#32;=&#32;optinal_params.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_optional_params_1ab0a4704479885c3da95f9e0bee91026d">ex_redu_rat</link>;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00091"/>00091 &#32;&#32;}&#32;<emphasis role="keywordflow">else</emphasis>&#32;{
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00092"/>00092 &#32;&#32;&#32;&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_base_info_1a01dc4c2e170bc8fd5a7a0a9f53492fa8">redu_rat</link>&#32;*=&#32;optinal_params.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_optional_params_1ab0a4704479885c3da95f9e0bee91026d">ex_redu_rat</link>;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00093"/>00093 &#32;&#32;}
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00094"/>00094 
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00095"/>00095 &#32;&#32;<emphasis role="comment">/*&#32;计算输入限制&#32;*/</emphasis>
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00096"/>00096 &#32;&#32;<emphasis role="keywordtype">float</emphasis>&#32;max_raw_input&#32;=&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_base_info_1a2b549445c9205d4d98b6afaab8a8a429">raw_input_lim</link>;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00097"/>00097 &#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(optinal_params.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_optional_params_1a406c5a28341a65489f7450f8800c7bc1">max_raw_input_lim</link>&#32;!=&#32;std::numeric_limits&lt;float&gt;::max())&#32;{
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00098"/>00098 &#32;&#32;&#32;&#32;max_raw_input&#32;=&#32;<link linkend="_namespacehello__world_1a94594f3432536927055026f3f48af251">hello_world::Min</link>(max_raw_input,&#32;optinal_params.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_optional_params_1a406c5a28341a65489f7450f8800c7bc1">max_raw_input_lim</link>);
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00099"/>00099 &#32;&#32;}
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00100"/>00100 &#32;&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_base_info_1a2b549445c9205d4d98b6afaab8a8a429">raw_input_lim</link>&#32;=&#32;max_raw_input;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00101"/>00101 &#32;&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_base_info_1a362055600c7cf9836de0659f3ea0b20a">torq_input_lim</link>&#32;=&#32;<link linkend="_namespacehello__world_1_1devices_1_1motor_1abe2e70f5aab1c0e73122df8bad6de6a0">kInvalidValue</link>;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00102"/>00102 &#32;&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_base_info_1a2ffd7b526a967afe22b3bdb838daea0b">curr_input_lim</link>&#32;=&#32;<link linkend="_namespacehello__world_1_1devices_1_1motor_1abe2e70f5aab1c0e73122df8bad6de6a0">kInvalidValue</link>;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00103"/>00103 }
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00104"/>00104 
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00112"/><link linkend="_classhello__world_1_1devices_1_1motor_1_1_g_m6020_1aa3824723dba2a9cd0d833fc02a7f49ff">00112</link> <link linkend="_namespacehello__world_1_1devices_1_1motor_1ae5d33e6b7fa4db1777f88ab1faf4380c">State</link>&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_g_m6020_1aa3824723dba2a9cd0d833fc02a7f49ff">GM6020::setInput</link>(<emphasis role="keywordtype">float</emphasis>&#32;input)
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00113"/>00113 {
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00114"/>00114 &#32;&#32;<emphasis role="keywordtype">float</emphasis>&#32;actual_input&#32;=&#32;0;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00115"/>00115 &#32;&#32;<emphasis role="keywordflow">switch</emphasis>&#32;(<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_info_1af8fc7f4030e24c85518c7239bcac9a86">input_type</link>)&#32;{
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00116"/>00116 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">case</emphasis>&#32;<link linkend="_namespacehello__world_1_1devices_1_1motor_1a4777995093ebbd290b833795e49749b7a3af8d233b879c0e5323904dd850fbfe3">kInputTypeRaw</link>:
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00117"/>00117 &#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a4e24f06845ffe971bca1914b11d353f1">raw_input_</link>&#32;=&#32;<link linkend="_namespacehello__world_1a34cb06299a34f746d556d23dc16904aa">hello_world::Bound</link>(
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00118"/>00118 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;input,&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_base_info_1a2b549445c9205d4d98b6afaab8a8a429">raw_input_lim</link>,&#32;-<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_base_info_1a2b549445c9205d4d98b6afaab8a8a429">raw_input_lim</link>);
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00119"/>00119 &#32;&#32;&#32;&#32;&#32;&#32;actual_input&#32;=&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a4e24f06845ffe971bca1914b11d353f1">raw_input_</link>;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00120"/>00120 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">break</emphasis>;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00121"/>00121 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">default</emphasis>:
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00122"/>00122 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_namespacehello__world_1_1devices_1_1motor_1ae5d33e6b7fa4db1777f88ab1faf4380cab9d834629e7bfe89857c5255d7afceb2">kStateInputTypeError</link>;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00123"/>00123 &#32;&#32;}
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00124"/>00124 
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00125"/>00125 &#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(fabsf(actual_input)&#32;&lt;&#32;fabsf(input))&#32;{
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00126"/>00126 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_namespacehello__world_1_1devices_1_1motor_1ae5d33e6b7fa4db1777f88ab1faf4380ca092964bcb48cb77568362247b1158499">kStateInputValueOverflow</link>;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00127"/>00127 &#32;&#32;}&#32;<emphasis role="keywordflow">else</emphasis>&#32;{
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00128"/>00128 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_namespacehello__world_1_1devices_1_1motor_1ae5d33e6b7fa4db1777f88ab1faf4380ca426fa281817a2eb81e04586488b8ca5a">kStateOk</link>;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00129"/>00129 &#32;&#32;}
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00130"/>00130 }
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00131"/>00131 
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00132"/><link linkend="_classhello__world_1_1devices_1_1motor_1_1_g_m6020_1a1235b577a72c9fa53a2732e04982cab0">00132</link> <link linkend="_namespacehello__world_1_1devices_1_1motor_1ae5d33e6b7fa4db1777f88ab1faf4380c">State</link>&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_g_m6020_1a1235b577a72c9fa53a2732e04982cab0">GM6020::set_input_type</link>(<link linkend="_namespacehello__world_1_1devices_1_1motor_1a4777995093ebbd290b833795e49749b7">InputType</link>&#32;input_type)
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00133"/>00133 {
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00134"/>00134 &#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(input_type&#32;==&#32;<link linkend="_namespacehello__world_1_1devices_1_1motor_1a4777995093ebbd290b833795e49749b7a3af8d233b879c0e5323904dd850fbfe3">kInputTypeRaw</link>)&#32;{
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00135"/>00135 &#32;&#32;&#32;&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_info_1af8fc7f4030e24c85518c7239bcac9a86">input_type</link>&#32;=&#32;input_type;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00136"/>00136 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_namespacehello__world_1_1devices_1_1motor_1ae5d33e6b7fa4db1777f88ab1faf4380ca426fa281817a2eb81e04586488b8ca5a">kStateOk</link>;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00137"/>00137 &#32;&#32;}&#32;<emphasis role="keywordflow">else</emphasis>&#32;{
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00138"/>00138 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_namespacehello__world_1_1devices_1_1motor_1ae5d33e6b7fa4db1777f88ab1faf4380cab9d834629e7bfe89857c5255d7afceb2">kStateInputTypeError</link>;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00139"/>00139 &#32;&#32;}
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00140"/>00140 }
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00141"/>00141 
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00151"/><link linkend="_classhello__world_1_1devices_1_1motor_1_1_g_m6020_1a5ad5ba687605e93d6723b3e6fa317435">00151</link> <link linkend="_namespacehello__world_1_1devices_1_1motor_1ae5d33e6b7fa4db1777f88ab1faf4380c">State</link>&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_g_m6020_1a5ad5ba687605e93d6723b3e6fa317435">GM6020::encode</link>(uint8_t&#32;tx_data[8],&#32;uint32_t&#32;tx_msg_std_id)<emphasis role="keyword">&#32;const</emphasis>
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00152"/>00152 <emphasis role="keyword"></emphasis>{
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00153"/>00153 &#32;&#32;<emphasis role="comment">/*&#32;变量检查&#32;*/</emphasis>
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00154"/>00154 <emphasis role="preprocessor">#pragma&#32;region</emphasis>
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00155"/>00155 &#32;&#32;<link linkend="_assert_8hpp_1a5969df827ceb603bed14c4106586484a">HW_ASSERT</link>(tx_data,&#32;<emphasis role="stringliteral">&quot;Error&#32;pointer&quot;</emphasis>);
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00156"/>00156 <emphasis role="preprocessor">#pragma&#32;endregion</emphasis>
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00157"/>00157 
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00158"/>00158 &#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(tx_msg_std_id&#32;!=&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_info_1a85fb9e3e5d5e207f69ad906f092b3ddc">tx_id</link>)&#32;{
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00159"/>00159 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_namespacehello__world_1_1devices_1_1motor_1ae5d33e6b7fa4db1777f88ab1faf4380ca3619ca83b453126a092443ae1a86b241">kStateIdDismatch</link>;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00160"/>00160 &#32;&#32;}&#32;<emphasis role="keywordflow">else</emphasis>&#32;{
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00161"/>00161 &#32;&#32;&#32;&#32;uint8_t&#32;index&#32;=&#32;(<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_info_1ad5c740f3c72547a3d4b6a9ac07eb52fe">id</link>&#32;-&#32;1)&#32;%&#32;4;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00162"/>00162 
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00163"/>00163 &#32;&#32;&#32;&#32;int16_t&#32;input&#32;=
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00164"/>00164 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_namespacehello__world_1a34cb06299a34f746d556d23dc16904aa">hello_world::Bound</link>(<emphasis role="keyword">static_cast&lt;</emphasis><emphasis role="keywordtype">float</emphasis><emphasis role="keyword">&gt;</emphasis>(<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_info_1a16bfca55d6a9c16d3bed3794f59eae55">dir</link>)&#32;*&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a4e24f06845ffe971bca1914b11d353f1">raw_input_</link>,
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00165"/>00165 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_base_info_1a2b549445c9205d4d98b6afaab8a8a429">raw_input_lim</link>,&#32;-<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_base_info_1a2b549445c9205d4d98b6afaab8a8a429">raw_input_lim</link>);
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00166"/>00166 &#32;&#32;&#32;&#32;tx_data[2&#32;*&#32;index]&#32;=&#32;input&#32;&gt;&gt;&#32;8;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00167"/>00167 &#32;&#32;&#32;&#32;tx_data[2&#32;*&#32;index&#32;+&#32;1]&#32;=&#32;input;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00168"/>00168 
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00169"/>00169 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_namespacehello__world_1_1devices_1_1motor_1ae5d33e6b7fa4db1777f88ab1faf4380ca426fa281817a2eb81e04586488b8ca5a">kStateOk</link>;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00170"/>00170 &#32;&#32;}
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00171"/>00171 }
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00172"/>00172 
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00181"/><link linkend="_classhello__world_1_1devices_1_1motor_1_1_g_m6020_1a732687f3fc5d5d302135f950ac260e3f">00181</link> <link linkend="_namespacehello__world_1_1devices_1_1motor_1ae5d33e6b7fa4db1777f88ab1faf4380c">State</link>&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_g_m6020_1a732687f3fc5d5d302135f950ac260e3f">GM6020::decode</link>(<emphasis role="keyword">const</emphasis>&#32;uint8_t&#32;rx_data[8],&#32;uint32_t&#32;rx_msg_std_id)
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00182"/>00182 {
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00183"/>00183 &#32;&#32;<emphasis role="comment">/*&#32;变量检查&#32;*/</emphasis>
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00184"/>00184 <emphasis role="preprocessor">#pragma&#32;region</emphasis>
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00185"/>00185 &#32;&#32;<link linkend="_assert_8hpp_1a5969df827ceb603bed14c4106586484a">HW_ASSERT</link>(rx_data,&#32;<emphasis role="stringliteral">&quot;Error&#32;pointer&quot;</emphasis>);
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00186"/>00186 <emphasis role="preprocessor">#pragma&#32;endregion</emphasis>
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00187"/>00187 
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00188"/>00188 &#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(rx_msg_std_id&#32;!=&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_info_1a3e96084a1a764a8bc1be4d4e34ef97b5">rx_id</link>)&#32;{
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00189"/>00189 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_namespacehello__world_1_1devices_1_1motor_1ae5d33e6b7fa4db1777f88ab1faf4380ca3619ca83b453126a092443ae1a86b241">kStateIdDismatch</link>;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00190"/>00190 &#32;&#32;}&#32;<emphasis role="keywordflow">else</emphasis>&#32;{
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00191"/>00191 &#32;&#32;&#32;&#32;uint16_t&#32;raw_angle&#32;=&#32;<emphasis role="keyword">static_cast&lt;</emphasis>uint16_t<emphasis role="keyword">&gt;</emphasis>((rx_data[0]&#32;&lt;&lt;&#32;8)&#32;|&#32;rx_data[1]);
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00192"/>00192 
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00193"/>00193 &#32;&#32;&#32;&#32;<emphasis role="comment">/*&#32;判断是否旋转了一圈&#32;*/</emphasis>
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00194"/>00194 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">float</emphasis>&#32;round&#32;=&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1ab037cc377320f41d8bdbdd599448dad8">round_</link>;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00195"/>00195 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">float</emphasis>&#32;delta_angle&#32;=&#32;raw_angle&#32;-&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1ade57cbc7fc217543ca6c8650ad0eb03d">last_raw_angle_</link>;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00196"/>00196 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(fabsf(delta_angle)&#32;&gt;&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_base_info_1a4b2d0ce1a40596b10eca0b17952a18f3">cross_0_value</link>&#32;*&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1ac4d15805fa2765480961cbb22a874832">kCross0ValueThres</link>)&#32;{
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00197"/>00197 &#32;&#32;&#32;&#32;&#32;&#32;delta_angle&#32;&lt;&#32;0&#32;?&#32;round++&#32;:&#32;round--;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00198"/>00198 
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00199"/>00199 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">/*&#32;避免圈数溢出&#32;*/</emphasis>
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00200"/>00200 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_info_1a9e6c4b4561b5da0bb08b88c80953eece">angle_range</link>&#32;!=&#32;<link linkend="_namespacehello__world_1_1devices_1_1motor_1a0163710b33b99ac98bcbcb1f43d78248a0e264d4f119a2e5d4c62691f3f35e317">kAngleRangeNegInfToPosInf</link>)&#32;{
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00201"/>00201 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;round&#32;=&#32;fmodf(round,&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_base_info_1a01dc4c2e170bc8fd5a7a0a9f53492fa8">redu_rat</link>);
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00202"/>00202 &#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00203"/>00203 &#32;&#32;&#32;&#32;}
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00204"/>00204 
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00205"/>00205 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">float</emphasis>&#32;actual_ang&#32;=
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00206"/>00206 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">static_cast&lt;</emphasis><emphasis role="keywordtype">float</emphasis><emphasis role="keyword">&gt;</emphasis>(<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_info_1a16bfca55d6a9c16d3bed3794f59eae55">dir</link>)&#32;*
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00207"/>00207 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;(raw_angle&#32;*&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_base_info_1a8f5d394a3576db17dd28638cee9df294">angle_rat</link>&#32;+&#32;round&#32;*&#32;2&#32;*&#32;<link linkend="_base_8hpp_1a598a3330b3c21701223ee0ca14316eca">PI</link>)&#32;/
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00208"/>00208 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_base_info_1a01dc4c2e170bc8fd5a7a0a9f53492fa8">redu_rat</link>;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00209"/>00209 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">float</emphasis>&#32;raw&#32;=&#32;<emphasis role="keyword">static_cast&lt;</emphasis><emphasis role="keywordtype">float</emphasis><emphasis role="keyword">&gt;</emphasis>(<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_info_1a16bfca55d6a9c16d3bed3794f59eae55">dir</link>)&#32;*
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00210"/>00210 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">static_cast&lt;</emphasis>int16_t<emphasis role="keyword">&gt;</emphasis>((rx_data[4]&#32;&lt;&lt;&#32;8)&#32;|&#32;rx_data[5]);
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00211"/>00211 
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00212"/>00212 &#32;&#32;&#32;&#32;<emphasis role="comment">/*&#32;统一对电机状态赋值&#32;*/</emphasis>
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00213"/>00213 &#32;&#32;&#32;&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1ab037cc377320f41d8bdbdd599448dad8">round_</link>&#32;=&#32;round;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00214"/>00214 &#32;&#32;&#32;&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1adac9b8b8484e8529d9cd10665b3a0f88">actual_angle_</link>&#32;=&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a21092858a98af5688b398d57cd203592">normAngle</link>(actual_ang);
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00215"/>00215 &#32;&#32;&#32;&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1ab7a9c137dd445327e658202640e3dbc6">angle_</link>&#32;=&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a21092858a98af5688b398d57cd203592">normAngle</link>(actual_ang&#32;-&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_info_1a7d770e09d97238decfb61382deac39eb">angle_offset</link>);
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00216"/>00216 &#32;&#32;&#32;&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a609eb51ef7ddb343ecc4eeafc4ad83e3">vel_</link>&#32;=&#32;<emphasis role="keyword">static_cast&lt;</emphasis><emphasis role="keywordtype">float</emphasis><emphasis role="keyword">&gt;</emphasis>(<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_info_1a16bfca55d6a9c16d3bed3794f59eae55">dir</link>)&#32;*
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00217"/>00217 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">static_cast&lt;</emphasis>int16_t<emphasis role="keyword">&gt;</emphasis>((rx_data[2]&#32;&lt;&lt;&#32;8)&#32;|&#32;rx_data[3])&#32;*
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00218"/>00218 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_base_info_1a178a3dba463610ff33a84ebc7a784e3a">vel_rat</link>&#32;/&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a59781c0f3a6d7bb179d93c61d837836d">motor_info_</link>.<link linkend="_structhello__world_1_1devices_1_1motor_1_1_motor_base_info_1a01dc4c2e170bc8fd5a7a0a9f53492fa8">redu_rat</link>;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00219"/>00219 &#32;&#32;&#32;&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a40c42d94607450fb55a676bdaa0b505c">torq_</link>&#32;=&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1af74a8c4ad7c0067a2d71afd711639366">raw2torq</link>(raw);
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00220"/>00220 &#32;&#32;&#32;&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a6b7de1c9857ad74e17bda1b03b524b21">curr_</link>&#32;=&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1a1e4467d9f449b9c6c7d6886fffa89667">raw2curr</link>(raw);
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00221"/>00221 &#32;&#32;&#32;&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_g_m6020_1acc42958e0eedf1f10da56e43d5df7946">temp_</link>&#32;=&#32;rx_data[6];
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00222"/>00222 
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00223"/>00223 &#32;&#32;&#32;&#32;<link linkend="_classhello__world_1_1devices_1_1motor_1_1_motor_1ade57cbc7fc217543ca6c8650ad0eb03d">last_raw_angle_</link>&#32;=&#32;raw_angle;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00224"/>00224 
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00225"/>00225 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_namespacehello__world_1_1devices_1_1motor_1ae5d33e6b7fa4db1777f88ab1faf4380ca426fa281817a2eb81e04586488b8ca5a">kStateOk</link>;
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00226"/>00226 &#32;&#32;}
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00227"/>00227 }
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00228"/>00228 }&#32;&#32;<emphasis role="comment">//&#32;namespace&#32;motor</emphasis>
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00229"/>00229 }&#32;&#32;<emphasis role="comment">//&#32;namespace&#32;devices</emphasis>
<anchor xml:id="_motor___g_m6020_8cpp_source_1l00230"/>00230 }&#32;&#32;<emphasis role="comment">//&#32;namespace&#32;hello_world</emphasis>
</programlisting></section>
